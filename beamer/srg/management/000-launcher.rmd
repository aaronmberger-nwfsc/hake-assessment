---
title: "Management outcomes of the `r rmarkdown::metadata$project_variables$assess_yr` Pacific Hake stock assessment"
project_variables:
  sp: "Pacific Hake"
  common_name: "Pacific whiting"
  science_name: "Merluccius productus"
  simple_name: "hake"
  survey_name: "Joint U.S. and Canadian Integrated Acoustic and Trawl Survey"
  assess_yr: 2023
  last_assess_yr: 2022
  last_data_yr: 2022
  forecast_yrs: 2023:2026
  models_dir: "/srv/hake/models"
  model_version: "01"
  last_yr_model_version: "01"
  ss_version: "3.30.20"
  fig_label_color: "black"
  fig_title_font_face: "plain"
  fig_tick_font_face: "plain"
  fig_title_font_size: 14
  fig_tick_font_size: 11
  fig_tick_length_cm: 0.15
  fig_height: 5
  fig_width: 8
  # margin arguments are in this order: top, right,bottom, left
  fig_margins: "margin(12, 12, 12, 12)"
  # The latex position by default for all figures. Modify individual
  # figure positions by editing the `doc/object-placement.csv` file
  fig_pos: "htb"
  fig_filetype: "png"
  knitr_figures_dir: "knitr-figs/"
  knitr_cache_dir: "knitr-cache/"
  out_csv_dir: "out-csv"
  # Increasing `dots_per_inch` for figure output increases the file size a LOT
  dots_per_inch: 100
  # To remove image, leave `title_page_image` blank. In that case,
  # `title_page_image_height_in` and `title_page_image_width_in` will be
  # ignored
  title_page_image: "../../images/hake-line-drawing.png"
  title_page_image_height_in: 1
  title_page_image_width_in: 2
author: Pacific Hake Joint Technical Committee
date: "SRG meeting -- `r rmarkdown::metadata$project_variables$assess_yr`"
output:
  hake_beamer:
    theme: Singapore
    slide_level: 2
    toc: false
    keep_tex: true
classoption: "aspectratio=169"
fontsize: 11pt
urlcolor: blue
header-includes:
  - \usepackage{makecell, booktabs, makecell, array, longtable, bm}
  - \makeatletter\def\fnum@table{\usebeamercolor{caption name}\usebeamerfont*{caption name}\tablename~\thetable}\makeatother
  - \usepackage[outdir=./knitr-figs/]{epstopdf}
  - \AtBeginSubsection{}
  - \AtBeginSection{}
  - \newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
  - \newcolumntype{C}[1]{>{\PreserveBackslash\centering}p{#1}}
  - \newcolumntype{R}[1]{>{\PreserveBackslash\raggedleft}p{#1}}
  - \newcolumntype{L}[1]{>{\PreserveBackslash\raggedright}p{#1}}
test: false # Do not modify, code modifies this when using hake::gotest()
---

```{r setup, echo = FALSE, cache = FALSE, message = FALSE, results = "hide", warning = FALSE}

# Current user's name on the system
# If regular desktop R session, use Sys.getenv("USERNAME")
# If on RStudio server, use Sys.getenv("RSTUDIO_USER_IDENTITY")
user <- ifelse(Sys.getenv("USERNAME") == "",
               Sys.getenv("RSTUDIO_USER_IDENTITY"),
               Sys.getenv("USERNAME"))

if(rmarkdown::metadata$test){
  # Necessary for `gotest()` testing
  if(user == "grandin"){
    devtools::load_all("~/github/pacific-hake/hake")
  }else{
    devtools::load_all("~/github/pacific-hake/hake-assessment")
  }
}else{
  # For regular doc build
  devtools::load_all(here::here())
}

# This grabs the YAML `project_variables` from above
yaml_proj_vars <- rmarkdown::metadata$project_variables

# Don't modify anything in `opts_chunk$set()`. Modify the YAML
# `project_variables` above
knitr::opts_chunk$set(
  # `collapse` - If `TRUE`, source code and output will remain together in
  # one chunk (inseparable from each other in the document). Probably
  # doesn't apply for this document but remains in case any source code is
  # shown
  collapse = TRUE,
  # Don't show warnings, messages, or source code (respectively)
  # in the document
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  # Create the `knitr_cache_dir` and `knitr_figs_dir` directories for caching
  cache = TRUE,
  cache.path = yaml_proj_vars$knitr_cache_dir,
  # cache.lazy - if `FALSE`, load the models at the beginning all at once
  cache.lazy = FALSE,
  # Prevents invalidation of the cache when only comments are entered
  # in chunks
  cache.comments = FALSE,
  results = "hide",
  comment = "#>",
  dev = yaml_proj_vars$fig_filetype,
  dpi = yaml_proj_vars$dots_per_inch,
  fig.path = yaml_proj_vars$knitr_figures_dir,
  fig.align = "center",
  fig.pos = yaml_proj_vars$fig_pos,
  fig.height = yaml_proj_vars$fig_height,
  fig.width = yaml_proj_vars$fig_width,
  out.height = "\\textheight",
  out.width = "\\textwidth")

fig_dir <- here("beamer/srg/management/knitr-figs")
if(!dir.exists(fig_dir)){
  dir.create(fig_dir)
}
```

