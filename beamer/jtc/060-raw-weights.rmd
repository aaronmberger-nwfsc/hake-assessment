# Weight proportions for Canadian fleets

```{r raw-weights-canada}

# `can_dat_lst` loaded at the bottom of `000-launcher.rmd`
ft_comm_samp <- can_dat_lst$commercial_samples |>
  filter(vessel_id %in% freezer_trawlers$gfbio_id) |>
  mutate(survey_abbrev = "Freezer Trawlers")

ss_comm_samp <- can_dat_lst$commercial_samples |>
  filter(!vessel_id %in% freezer_trawlers$gfbio_id) |>
  mutate(survey_abbrev = "Shoreside")

comm_samp <- ft_comm_samp |>
  bind_rows(ss_comm_samp)

# Hack to make the weight plot look like the length plot. Remove length column
# and rename weight column to length, create the bins and data frame format
# the same way as length using the length-based function, and then rename
# the length_bin column to weight_bin after
comm_samp <- comm_samp |> 
  select(-length) |> 
  rename(length = weight) |> 
  # Make it in kg
  mutate(length = length / 1e3)

weights_raw <- tidy_lengths_raw(comm_samp,
                                survey = c("Freezer Trawlers", "Shoreside"),
                                bin_size = 0.1,
                                year_range = seq(last_data_yr - 4, last_data_yr)) |> 
  rename(weight_bin = length_bin)

plot_weights(weights_raw,
             bin_width = 0.075,
             x_breaks = seq(0, 2, 0.2),
             label_font_size = 2.25,
             fill_col = c("F" = rgb(1, 0, 0, 0.3), # red with transparency
                          "M" = rgb(0, 0, 1, 0.3)), # blue with transparency
             unit_str = "kg")
```